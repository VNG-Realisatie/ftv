---
weight: 40
title: "De oplossing"
---

# De methodiek: PBAC in een federatief stelsel

De voorgestelde oplossing is: 
> Maak gebruik van PBAC, waar mogelijk in een federatief stelsel.

Dit is ook beschreven in het FDS position paper, in [dit hoofdstuk.](https://federatief.datastelsel.nl/kennisbank/pbac/#hoe-werkt-pbac-over-verschillende-organisaties-in-een-federatief-datastelsel)

## Generieke architectuur van een koppelvlak

In generieke zin is de architectuur van elke API-koppeling te beschrijven in onderstaand diagram:

![Generieke architectuur digikoppeling](/images/1.2.3.4.1_architectuur_digikoppeling.png)

Links zien we de afnemer, het systeem dat om gegevensverwerking vraagt, en rechts de aanbieder, die de dienst levert.
Verwerking bedoelen we hier in de brede zin: dat kan opvragen van gegevens zijn, maar ook aanpassen of verwijderen daarvan.

Beide kanten hebben vrijwel dezelfde componenten, met als belangrijkste verschil dat links een applicatie staat, en rechts een API. 
Beide kanten hebben ook een API-gateway waarmee de andere kant gevonden kan worden en de verbinding beveiligd. 
Bij de beveiliging hoort in de overheidssituatie altijd een OIN PKI-certificaat. 
Daarnaast is er een vorm van identificatie en authenticatie: het vaststellen en verifiÃ«ren van de identiteit van de vrager. 
Dit kan ingebouwd zijn in de applicatie/API, in de gateway, of elders. Deze opzet wordt als uitgangspunt genomen en bekend verondersteld.


## Generieke architectuur van een federatief koppelvlak

In het FDS is de architectuur iets uitgebreider:

![Architectuur federatieve koppeling](/images/1.2.3.4.2_architectuur_federatieve_koppeling.png)

FSC (Federatieve Service Connectiviteit) is hier de naam voor de invulling van de transactielaag.

Daarnaast zijn de volgende componenten toegevoegd:
- Toegangsverlening: een vorm van bepalen wat inhoudelijk mag qua diensten en gegevens. Bij open API's zal dit niet bestaan of
slechts heel rudimentair, in andere API's zal dit heel uitgebreid zijn.
- Transactielogging: een log van de transacties op het transportniveau. De gateway meldt hierin gegevens zoals tijdstip, certificaat, ip adres
van de aanvrager, etc. De inhoud van het bericht zelf wordt hier niet in meegenomen. 
- Verwerkingenlogging: een log op applicatieniveau waarin juist wel de inhoud van het bericht centraal staat, en daarbij gegevens
zoals de grondslag van de verwerking bewaard blijven.

Transactielogging is hier bij de gateway getekend omdat het voor de hand ligt dat die verantwoordelijkheid daar ligt, hoewel dat niet verplicht is.
Toegangsverlening en verwerkingenlogging zijn tussen de applicatie/API en de gateway getekend, omdat het in de
architectuur vrijgelaten wordt waar de verantwoordelijkheid komt te liggen: links, rechts of in een nieuwe, apart, component.

We richten ons in de rest van dit onderzoek alleen op toegangsverlening. We houden daarbij wel in het achterhoofd dat
er een belangrijke relatie met verwerkingenlogging zal zijn, omdat de verwerkingenlogging (naast andere gegevens) 
de beslissing van toegangsverlening moet vastleggen. 

## Generieke architectuur van PBAC-toegangsverlening

Een PBAC-oplossing heeft de volgende generieke architectuur:
![Architectuur PBAC](/images/1.2.3.4.3_architectuur_pbac.png)
- Zie voor een uitleg van de onderdelen van PBAC zelf [deze pagina](../../../5.architectuur/inventarisatie/standaarden/PBAC)
- Toegangsverlening start als de PEP wordt aangesproken door de applicatie/API of de gateway. Beiden hebben de mogelijkheid om een transactie
door te laten gaan of te blokkeren, en daarmee af te dwingen dat de toegangsbeslissing gehonoreerd wordt. In de FDS-architectuur
is gekozen om FSC de aanroep te laten doen, de gateway dus.
- De PEP, PDP, PIP en PAP zijn software componenten met elk een eigen functie, maar zonder eigen opslag van gegevens. Ze halen gegevens
uit de aanvraag, de toegangsregels en de opgehaalde gegevens en gebruiken die om de regels te evalueren en een beslissing te nemen.
- De toegangsregels moeten buiten de software zijn opgeslagen, op een plek die bereikbaar is voor mensen en systemen van buiten zodat audits gedaan kunnen worden.

## Generieke architectuur van federatief PBAC

![Architectuur federatief PBAC](/images/1.2.3.4.4_architectuur_federatief_pbac.png)

Een federatieve PBAC-oplossingen voegt hier nog het volgende toe:
- Beide kanten implementeren PBAC. Het is niet noodzakelijk dat ze dezelfde implementatie daarvoor kiezen.
- Beide kanten delen dezelfde toegangsregels. In een federatief stelsel ligt het voor de hand daar een gedistribueerde oplossing voor te kiezen.
Dit in tegenstelling tot een enkele database, zodat er geen enkel kritisch systeem ontstaat. En ook niet losse systemen die handmatig 
synchroon gehouden moeten worden.

![Moderne autorisatie versie 1](/architecture/modern-auth-pbac1.png)

Voor meer informatie zie ook [ontwerp](../../../5.architectuur/ontwerp)


![Moderne autorisatie versie 2](/architecture/modern-auth-pbac2.png)

# De implementatie

> Nader uit te werken aspecten zijn:
> - Welke **notatiestandaard** er zijn en vergelijken.
> - Welke **policy engines** er zijn en/of te bouwen (zie [PBAC](../../../5.architectuur/inventarisatie/pbac)).
> - **Beheer van policies.** Het beheer van toegangsregels wordt snel bewerkelijk. Van RBAC en ABAC wordt gezegd dat het snel onoverzichtelijk
wordt als er veel rollen respectievelijk attributen zijn. Bij PBAC kan dat net zo goed gebeuren, zeker omdat de regels
in de meeste notaties lastig te lezen zijn. 
> - **Logging** Vergelijk IDS-Ram clearing house concept

